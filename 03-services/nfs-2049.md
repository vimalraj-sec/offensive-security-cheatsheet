## CHECKS

```md
# Check if NFS is exposed (2049)
# List exported shares
# Mount accessible shares
# Check for no_root_squash
# Look for writable directories
# Search for sensitive files
```
## LIST SHARES

```bash
# Nmap Script
sudo nmap -p 2049 --script nfs-showmount $ip

# Showmount
sudo showmount -e $ip
```
## NMAP – NFS SCRIPTS

```bash
sudo nmap -p 2049 --script nfs-ls,nfs-showmount,nfs-statfs $ip
```
## MOUNT SHARE

```bash
# STEP 1 – Create Local Mount Directory
mkdir /mnt/mntshare

# STEP 2 – Mount the Share
sudo mount -v -t nfs $ip:<SHARE> /mnt/mntshare

# Syntax Variations
sudo mount -v -t nfs $ip:<SHARE> <DIRECTORY>
sudo mount -v -t nfs -o vers=2 $ip:<SHARE> <DIRECTORY>
sudo mount -t nfs -o vers=3,nolock $ip:<SHARE> <DIRECTORY>
```
## MOUNTING (Manual Method)

```bash
# List Shares
showmount -e $ip

# Mount Share
mount -t nfs [-o vers=2] <ip>:<remote_folder> <local_folder> -o nolock

# Example
mkdir razorshare
sudo mount -t nfs -o vers=3,nolock 10.201.46.20:/users ./razorshare
```
## METASPLOIT

```bash
# Scan NFS mounts and permissions
scanner/nfs/nfsmount
```
## NFSSHELL

```md
GitHub:
https://github.com/NetDirect/nfsshell

Guide:
https://www.pentestpartners.com/security-blog/using-nfsshell-to-compromise-older-environments/
```
## IMPORTANT CONFIG FILES (On Target)

```md
/etc/exports
/etc/lib/nfs/etab
```
## PRIVILEGE ESCALATION – NFS MISCONFIGURATION

```md
If "no_root_squash" is enabled:
- Remote root becomes local root
- Can upload SUID binaries
- Can create SSH keys for root

Reference:
https://book.hacktricks.xyz/linux-hardening/privilege-escalation/nfs-no_root_squash-misconfiguration-pe
```
## NOTES

```md
- NFS typically runs on TCP 2049
- Often found in Linux environments
- no_root_squash = critical misconfiguration
- Writable shares = high exploitation potential
- Always check mounted permissions (rw, root access)
```
