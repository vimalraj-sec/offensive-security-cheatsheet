## CHECKS

```md
# Check IMAP banner and version
# Check for cleartext authentication (143)
# Check SSL/TLS IMAPS (993)
# Check for NTLM authentication disclosure
# Attempt login with weak credentials
```
## BANNER GRABBING

```bash
# IMAP (Plaintext)
nc -nv $ip 143

# IMAPS (SSL)
openssl s_client -connect $ip:993 -quiet
```
## NTLM AUTH â€” INFORMATION DISCLOSURE

```bash
telnet $ip 143
```

```bash
a1 AUTHENTICATE NTLM
TlRMTVNTUAABAAAAB4IIAAAAAAAAAAAAAAAAAAAAAAA=
```

If NTLM is enabled, server may leak:

* Domain name
* Hostname
* OS information
## BASIC IMAP COMMANDS

```bash
LOGIN <username> <password>     # Authenticate
SELECT <mailbox>                # Select mailbox (e.g., inbox)
FETCH <id> body[]               # Retrieve email content
MOVE <id> <mailbox>             # Move message
COPY <id> <mailbox>             # Copy message
LOGOUT                          # Exit
```

## MAIL RETRIEVAL EXAMPLE

```bash
telnet $ip 143

A LOGIN username password
B SELECT inbox
C FETCH 3 body[]
D LOGOUT
```

Example fetch:

```bash
FETCH 3 body[]
```

Retrieves:

* Headers
* Body content
* Credentials (sometimes found in emails)
## FULL IMAP SESSION EXAMPLE

```bash
telnet $ip 143

A LOGIN user password
B SELECT inbox
C FETCH 1 body[]
D LOGOUT
```

Look for:

* Password reset emails
* Internal credentials
* Sensitive attachments
## SETUP LOCAL MAIL SERVER (Testing)

```bash
# Mail Client
sudo apt install evolution

# Debug SMTP Server
sudo python -m smtpd -n -c DebuggingServer localhost:25
```
## NOTES

```md
- 143 = IMAP (plaintext)
- 993 = IMAPS (SSL)
- Often used with SMTP (25/587)
- Valuable for credential harvesting
- NTLM auth may reveal internal domain info
```
