## BANNER GRABBING

```bash
# Plain POP3
nc -nv $ip 110

# POP3 with STARTTLS
openssl s_client -connect $ip:110 -starttls pop3

# POP3S (SSL/TLS)
openssl s_client -connect $ip:995 -crlf -quiet
```

## BASIC ENUMERATION

```bash
telnet $ip 110
```

### Common POP3 Commands

```md
USER username       # Identify user
PASS password       # Authenticate

STAT                # Show number of messages & total size
LIST                # List messages & sizes
RETR n              # Retrieve message number n
DELE n              # Mark message n for deletion
RSET                # Reset deletion marks
TOP msg n           # Show first n lines of message
CAPA                # Show server capabilities
QUIT                # End session
```

## NMAP ENUMERATION

```bash
# Default POP3 Scripts
sudo nmap --script "pop3-capabilities or pop3-ntlm-info" -sV -p 110 $ip

# POP3S
sudo nmap -sV -p 995 $ip
```

## AUTHENTICATION FLOW EXAMPLE

```md
USER <username>            # Identify user
PASS <password>            # Provide password
STAT                       # Check mailbox stats
LIST                       # List all messages
RETR <message_number>      # Retrieve specific message
DELE <message_number>      # Mark for deletion
QUIT                       # End session (apply changes)
```

## RECEIVE MAIL â€” FULL EXAMPLE

```bash
telnet $ip 110

USER strategos
PASS password
STAT
LIST
RETR 3
QUIT
```

Example Output:

```bash
+OK 3 messages:
1 407
2 412
3 445
```

Retrieving message:

```bash
RETR 3
```

Displays full email headers and body.

## WHAT TO LOOK FOR

```md
# Default credentials
# Weak credentials
# Cleartext authentication
# NTLM support (information leakage)
# Sensitive information inside emails
# Internal IPs / credentials inside mail content
```
